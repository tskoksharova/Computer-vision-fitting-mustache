<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mustache Try-On — OpenCV.js</title>

  <link rel="stylesheet" href="./css/styles.css">

  <script>
    var Module = {
      onRuntimeInitialized() {
        window.__opencvReady = true;
        window.dispatchEvent(new Event('opencv-ready'));
      }
    };
  </script>

  <script async src="https://docs.opencv.org/4.x/opencv.js" type="text/javascript"></script>
</head>

<body>
  <h2>Примерочная усов</h2>
  <p class="hint">
    Загрузите фото "Лицо в анфас" - нажмите «Найти лицо» → выберите усы → настройте размер/смещение → скачайте результат.
  </p>

  <div class="panel controls">
    <div class="topline">
      <label>
        Фото:
        <input id="fileInput" type="file" accept="image/*">
      </label>

      <span id="status" class="badge">загружается…</span>
    </div>

    <div class="btns">
      <button id="btnDetect" disabled>Найти лицо</button>
      <button id="btnDownload" disabled>Скачать PNG</button>
    </div>

    <div class="panel-lite">
      <div class="section-title">Выберите усы</div>
      <div id="mustacheGrid" class="mustache-grid"></div>
      <div class="hint small"></div>
    </div>

    <div class="sliders">
      <div class="section-title">Настройки</div>

      <div class="slider-row">
        <label>
          Размер:
          <input id="scaleRange" type="range" min="0.35" max="0.95" step="0.01" value="0.65" disabled>
        </label>
        <span id="scaleVal">0.65</span>
      </div>

      <div class="slider-row">
        <label>
          Смещение X:
          <input id="xRange" type="range" min="-0.30" max="0.30" step="0.01" value="0.00" disabled>
        </label>
        <span id="xVal">0.00</span>
      </div>

      <div class="slider-row">
        <label>
          Смещение Y:
          <input id="yRange" type="range" min="0.50" max="0.85" step="0.01" value="0.68" disabled>
        </label>
        <span id="yVal">0.68</span>
      </div>

      <div class="hint small">
        X — в долях ширины лица (влево/вправо). Y — позиция усов по высоте лица (примерно под носом).
      </div>
    </div>
  </div>

  <div class="row">
    <div class="panel">
      <h3>Результат</h3>
      <canvas id="canvasOut"></canvas>
      <div class="hint small">Совет: лучше фото анфас, без поворота головы, с нормальным светом.</div>
    </div>
  </div>

  <script src="./js/app.js"></script>
</body>
</html>